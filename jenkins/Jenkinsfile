pipeline {
      agent any
      tools {
          nodejs "NodeJS 12"
      }
      stages {
          stage('Checkout') {
              steps {
                  git branch: 'master',
                      url: 'https://gitlab.com/assistiverobot/assistiverobot.web.application.git'
                  echo 'Checkout complete'
              }
          }
          stage('Deploy Main Web App') {
              steps {
                  bat 'appcmd stop apppool /apppool.name:\"Toktak Web App\"'
                  bat 'npm install'
                  bat 'npm run ng -- build --prod --outputPath=D:\\Toktak-Web-App\\dist\\website --base-href /app/'
                  bat 'appcmd start apppool /apppool.name:\"Toktak Web App\"'
              }
          }
          stage('Deploy Kobuki Web App') {
              steps {
                  bat 'appcmd stop apppool /apppool.name:\"Toktak Kobuki Web App\"'
                  bat 'npm install'
                  bat 'npm run ng -- build --prod --project kobuki --outputPath=D:\\Toktak-Kobuki-Web-App\\dist\\website --base-href /kobuki-app/'
                  bat 'appcmd start apppool /apppool.name:\"Toktak Kobuki Web App\"'
              }
          }
      }
}
